# ============================================
# LOG4J2 CONFIGURATION - onGas Gateway
# ============================================

# Status logger level
status = warn

# Nome della configurazione
name = OnGasMeteorLogConfig

# ============================================
# PROPERTIES
# ============================================

property.LOG_PATTERN = %d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n
property.LOG_DIR = logs

# ============================================
# APPENDERS
# ============================================

# Console Appender
appender.console.type = Console
appender.console.name = Console
appender.console.target = SYSTEM_OUT
appender.console.layout.type = PatternLayout
appender.console.layout.pattern = ${LOG_PATTERN}

# Gateway File Appender
appender.meteorfile.type = RollingFile
appender.meteorfile.name = GatewayFile
appender.meteorfile.fileName = ${LOG_DIR}/ongas-gateway.log
appender.meteorfile.filePattern = ${LOG_DIR}/ongas-gateway-%d{yyyy-MM-dd}-%i.log.gz
appender.meteorfile.layout.type = PatternLayout
appender.meteorfile.layout.pattern = ${LOG_PATTERN}
appender.meteorfile.policies.type = Policies
appender.meteorfile.policies.time.type = TimeBasedTriggeringPolicy
appender.meteorfile.policies.time.interval = 1
appender.meteorfile.policies.time.modulate = true
appender.meteorfile.policies.size.type = SizeBasedTriggeringPolicy
appender.meteorfile.policies.size.size = 100MB
appender.meteorfile.strategy.type = DefaultRolloverStrategy
appender.meteorfile.strategy.max = 30

# Access Log Appender
appender.accesslog.type = RollingFile
appender.accesslog.name = AccessLog
appender.accesslog.fileName = ${LOG_DIR}/access.log
appender.accesslog.filePattern = ${LOG_DIR}/access-%d{yyyy-MM-dd}-%i.log.gz
appender.accesslog.layout.type = PatternLayout
appender.accesslog.layout.pattern = %d{yyyy-MM-dd HH:mm:ss.SSS} - %msg%n
appender.accesslog.policies.type = Policies
appender.accesslog.policies.time.type = TimeBasedTriggeringPolicy
appender.accesslog.policies.time.interval = 1
appender.accesslog.policies.time.modulate = true
appender.accesslog.policies.size.type = SizeBasedTriggeringPolicy
appender.accesslog.policies.size.size = 100MB
appender.accesslog.strategy.type = DefaultRolloverStrategy
appender.accesslog.strategy.max = 30

# Error File Appender
appender.errorfile.type = RollingFile
appender.errorfile.name = ErrorFile
appender.errorfile.fileName = ${LOG_DIR}/error.log
appender.errorfile.filePattern = ${LOG_DIR}/error-%d{yyyy-MM-dd}-%i.log.gz
appender.errorfile.layout.type = PatternLayout
appender.errorfile.layout.pattern = ${LOG_PATTERN}
appender.errorfile.policies.type = Policies
appender.errorfile.policies.time.type = TimeBasedTriggeringPolicy
appender.errorfile.policies.time.interval = 1
appender.errorfile.policies.time.modulate = true
appender.errorfile.policies.size.type = SizeBasedTriggeringPolicy
appender.errorfile.policies.size.size = 50MB
appender.errorfile.strategy.type = DefaultRolloverStrategy
appender.errorfile.strategy.max = 30
appender.errorfile.filter.threshold.type = ThresholdFilter
appender.errorfile.filter.threshold.level = ERROR
appender.errorfile.filter.threshold.onMatch = ACCEPT
appender.errorfile.filter.threshold.onMismatch = DENY

# ============================================
# LOGGERS
# ============================================

# Logger per il Gateway (com.ongas.gateway)
logger.meteor.name = com.ongas.meteor
logger.meteor.level = DEBUG
logger.meteor.additivity = false
logger.meteor.appenderRef.console.ref = Console
logger.meteor.appenderRef.gatewayfile.ref = MeteorFile
logger.meteor.appenderRef.errorfile.ref = ErrorFile

# Logger per Spring Cloud Gateway
logger.springgateway.name = org.springframework.cloud.gateway
logger.springgateway.level = INFO
logger.springgateway.additivity = false
logger.springgateway.appenderRef.console.ref = Console
logger.springgateway.appenderRef.gatewayfile.ref = MeteorFile

# Logger per richieste HTTP (Access Log)
logger.webreactive.name = org.springframework.web.reactive
logger.webreactive.level = DEBUG
logger.webreactive.additivity = false
logger.webreactive.appenderRef.accesslog.ref = AccessLog

# ============================================
# ROOT LOGGER
# ============================================

rootLogger.level = INFO
rootLogger.appenderRef.console.ref = Console
rootLogger.appenderRef.gatewayfile.ref = MeteorFile
rootLogger.appenderRef.errorfile.ref = ErrorFile